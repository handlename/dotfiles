---
name: codify
description: セッションで得た教訓をCLAUDE.mdのルールまたはskillとして成文化する
disable-model-invocation: true
---

# Codify

## Overview

セッションで得た教訓を、CLAUDE.md のルールまたは skill として成文化する。

## When to Use

- `/codify <教訓>` — 指定した教訓を記録するフローに入る
- `/codify` (引数なし) — セッションの文脈から教訓を推測し提案する

## Process

### Step 1: 教訓の特定

`$ARGUMENTS` が与えられた場合はその内容を教訓として扱う。

与えられなかった場合は、セッションの文脈から以下を分析せよ:
- 試行錯誤して解決した問題
- 当初の想定と異なった挙動
- 繰り返し発生しうるパターン

推測した教訓をユーザーに提示し、承認を得てから次へ進め。

### Step 2: 振り分け提案

教訓の内容を分析し、記録先を提案せよ。**ユーザーの承認を得てから次へ進め。**

| 振り分け先 | 基準 | 例 |
|:--|:--|:--|
| CLAUDE.md | 汎用的なルール、制約、スタイル規約 | 「Nix式ではletの中でrecを使わない」 |
| 新規 skill | 特定ワークフローの手順、複数ステップの作業手順 | 「新しいモジュール追加時の手順」 |
| 既存 skill の補強 | 既存 skill の対象領域に関する知見 | 「tagpr でリリースノートにラベルを反映する方法」 |

**判断に迷う場合:** CLAUDE.md を優先せよ。skill は手順が明確に複数ステップある場合のみ。

### Step 3: 重複・矛盾チェック

記録先の既存内容を読み取り、重複・矛盾がないか確認せよ。

- **問題なし** → Step 4 へ進む
- **重複・矛盾あり** → ユーザーに報告し、以下から選択してもらう:
  - **追記** — 既存と併存させる
  - **更新** — 既存の記述を置き換える
  - **中止** — 記録しない

### Step 4: 記録

#### CLAUDE.md に記録する場合

- 既存の見出し構造 `# (重要度) 見出し` に従え
- 重要度は `MUST`, `SHOULD`, `MAY` から選択し、ユーザーに提案せよ
- 追記位置は内容の関連性に基づいて判断せよ
- 既存のCLAUDE.mdの文体（命令形、簡潔）に合わせよ

**CLAUDE.md のパス:** `config/claude/CLAUDE.md`

#### 新規 skill を作成する場合

- パス: `config/claude/skills/<skill-name>/SKILL.md`
- 既存 skill（`github-resource-access` 等）の構造・文体を参考にせよ
- 日本語で記述せよ
- フロントマターには少なくとも `name` と `description` を含めよ

#### 既存 skill を補強する場合

- 対象 skill の SKILL.md を読み取り、既存の構造を把握せよ
- 既存の文体・構造に合わせて追記せよ

### Step 5: 完了報告

変更内容のサマリーをユーザーに表示せよ。以下を含めること:
- 何を記録したか（教訓の要約）
- どこに記録したか（ファイルパス）
- 変更の差分概要
